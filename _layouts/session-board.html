<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Sitzung</title>

  <!-- Assets kommen von /app/, unabhÃ¤ngig davon wo die HTML-Datei liegt -->
  <base href="/app/">

  <!-- CSS (absolute Pfade) -->
  <link rel="stylesheet" href="/app/assets/css/board-styles.css">
  <link rel="stylesheet" href="/app/assets/css/kartensets.css">
  <link rel="stylesheet" href="assets/css/board.css?v=1">

  <!-- Fallback: wenn /app/ nicht erreichbar ist, probiere /kartensets/ -->
  <script>
    (function () {
      function add(href) {
        var l = document.createElement('link');
        l.rel = 'stylesheet'; l.href = href;
        document.head.appendChild(l);
        return l;
      }
      window.addEventListener('error', function (e) {
        if (e.target && e.target.tagName === 'LINK' && /assets\/css\//.test(e.target.href)) {
          var alt = e.target.href.replace('/app/', '/kartensets/');
          if (alt !== e.target.href) add(alt);
        }
      }, true);
    })();
  </script>
</head>


<body>
  <div class="board-container">
    <header class="board-title-only">
      <h1 id="board-title">Sitzung</h1>
      <div id="error-container" class="error-message hidden">
        <p id="error-message"></p>
      </div>
    </header>


    <div id="error-container" class="error-message hidden">
      <p id="error-message"></p>
    </div>

    <main id="session-board" class="board-area">
      <!-- Hier werden die Kartenpositionen angezeigt -->
      <div id="card-placeholders">
        <div class="card-placeholder" data-position="1">Platz 1</div>
        <div class="card-placeholder" data-position="2">Platz 2</div>
        <div class="card-placeholder" data-position="3">Platz 3</div>
      </div>
      
      <div id="cards-container" class="cards-container"></div>
      <div id="notes-container" class="notes-container"></div>
    </main>

    <footer class="board-footer">
      <div id="participants-container" class="participants-container"></div>
    </footer>
  </div>

  <script>
    (function () {
      const qs = new URLSearchParams(location.search);
      const nameFromUrl = qs.get('name') || qs.get('n');
      const h1 = document.getElementById('board-title');

      if (nameFromUrl && h1) h1.textContent = nameFromUrl;

      // CC_BOOT vorbereiten, damit nachladende Skripte denselben Namen sehen
      window.CC_BOOT = window.CC_BOOT || {};
      window.CC_BOOT.session = Object.assign(
        { id: qs.get('id') || qs.get('session') || null },
        window.CC_BOOT.session || {},
        nameFromUrl ? { name: nameFromUrl } : {}
      );
    })();
  </script>

  <!-- Sound-Effekte -->
  <audio id="shuffle-sound" src="assets/sounds/shuffle.mp3" preload="auto"></audio>
  <audio id="card-flip-sound" src="assets/sounds/card-flip.mp3" preload="auto"></audio>

  <!-- JavaScript einbinden -->
  <script src="/app/assets/js/session-storage.js"></script>
  <script src="/app/assets/js/participant-join.js"></script>
  <script src="/app/assets/js/board-interaction.js"></script>
</body>
</html>
