<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Sitzung</title>

  <!-- Assets kommen von /app/, unabhängig davon wo die HTML-Datei liegt -->
  <base href="/app/">

  <!-- CSS (absolute Pfade) -->
  <link rel="stylesheet" href="/app/assets/css/board-styles.css">
  <link rel="stylesheet" href="/app/assets/css/kartensets.css">
  <link rel="stylesheet" href="assets/css/board.css?v=1">

  <!-- Fallback: wenn /app/ nicht erreichbar ist, probiere /kartensets/ -->
  <script>
    (function () {
      function add(href) {
        var l = document.createElement('link');
        l.rel = 'stylesheet'; l.href = href;
        document.head.appendChild(l);
        return l;
      }
      window.addEventListener('error', function (e) {
        if (e.target && e.target.tagName === 'LINK' && /assets\/css\//.test(e.target.href)) {
          var alt = e.target.href.replace('/app/', '/kartensets/');
          if (alt !== e.target.href) add(alt);
        }
      }, true);
    })();
  </script>

  <script>
    (function () {
      var p = new URLSearchParams(location.search);
      var isOwner = p.get('owner') === '1';
      document.documentElement.setAttribute('data-ccs-owner', isOwner ? '1' : '0');
      if (!isOwner) return;
      var st = document.createElement('style');
      st.id = 'owner-hide-style';
      st.textContent =
        '[data-ccs-owner="1"] #participant-name-prompt,' +
        '[data-ccs-owner="1"] .participant-name-prompt-overlay,' +
        '[data-ccs-owner="1"] #session-password-prompt' +
        '{display:none!important;visibility:hidden!important}';
      document.head.appendChild(st);
    })();
    </script>
</head>

<!-- OWNER-KILL-SWITCH: VOR allen anderen Scripts einfügen -->
<script>
(function(){
  var p = new URLSearchParams(location.search);
  if (p.get('owner') === '1') {
    document.documentElement.setAttribute('data-ccs-owner','1');
    var st = document.createElement('style');
    st.textContent =
      '[data-ccs-owner="1"] #participant-name-prompt,'+
      '[data-ccs-owner="1"] .participant-name-prompt-overlay,'+
      '[data-ccs-owner="1"] #session-password-prompt{display:none!important;visibility:hidden!important}';
    document.head.appendChild(st);
  } else {
    document.documentElement.setAttribute('data-ccs-owner','0');
  }
})();
</script>

<body>
    <div id="error-container" class="error-message hidden">
      <p id="error-message"></p>
    </div>

    <main id="session-board"
      class="board-container board-area"
      data-world-w="2400"
      data-world-h="1350">
      <!-- Hier werden die Kartenpositionen angezeigt -->
      <div id="card-placeholders">
        <div class="card-placeholder" data-position="1">Platz 1</div>
        <div class="card-placeholder" data-position="2">Platz 2</div>
        <div class="card-placeholder" data-position="3">Platz 3</div>
      </div>
      
      <div id="cards-container" class="cards-container"></div>
      <div id="notes-container" class="notes-container"></div>
    </main>

    <footer class="board-footer">
      <div id="participants-container" class="participants-container"></div>
    </footer>

  <!-- Sound-Effekte -->
  <audio id="shuffle-sound" src="assets/sounds/shuffle.mp3" preload="auto"></audio>
  <audio id="card-flip-sound" src="assets/sounds/card-flip.mp3" preload="auto"></audio>



  <!-- JavaScript einbinden -->
  <script src="/app/assets/js/session-storage.js"></script>
  <script src="/app/assets/js/participant-join.js"></script>
  <script src="/app/assets/js/board-interaction.js"></script>
</body>
</html>
